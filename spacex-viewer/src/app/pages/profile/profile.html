<section class="auth-page">
  <div class="auth-card profile-card">
    <h2>{{ i18n.translate('profile.title') }}</h2>

    <div *ngIf="user$ | async as user; else noUser">

      <!-- Ğ’ĞµÑ€Ñ…Ğ½Ğ¸Ğ¹ Ğ±Ğ»Ğ¾Ğº: Ğ°Ğ²Ğ°Ñ‚Ğ°Ñ€ + Ğ¾ÑĞ½Ğ¾Ğ²Ğ½Ğ°Ñ Ğ¸Ğ½Ñ„Ğ° -->
      <div class="profile-header" *ngIf="profile$ | async as profile">
        <div class="avatar-wrapper">
          <ng-container *ngIf="profile?.photoData; else avatarPlaceholder">
            <img
              [src]="profile.photoData"
              alt="Profile photo"
              class="avatar-img"
            />
          </ng-container>

          <ng-template #avatarPlaceholder>
            <div class="avatar-placeholder">
              {{ user.email?.charAt(0) | uppercase }}
            </div>
          </ng-template>
        </div>

        <div class="profile-info">
          <div class="profile-email">
            <span class="info-icon">âœ‰ï¸</span>
            <span class="info-text">{{ user.email }}</span>
          </div>
          <div class="profile-uid">
            <span class="info-icon">ğŸ†”</span>
            <span class="info-text">{{ user.uid }}</span>
          </div>
        </div>
      </div>

      <hr class="profile-separator" />

      <!-- Ğ—Ğ°Ğ³Ñ€ÑƒĞ·ĞºĞ° ĞºĞ°Ñ€Ñ‚Ğ¸Ğ½ĞºĞ¸ -->
      <div class="upload-section">
        <label class="upload-label" for="profile-photo-input" [class.uploading]="uploading">
          <span class="upload-icon">ğŸ“·</span>
          <span class="upload-text">{{ i18n.translate('profile.upload') }}</span>
          <span class="upload-hint">{{ i18n.translate('profile.upload.hint') }}</span>
        </label>
        <input
          type="file"
          accept="image/*"
          (change)="onFileSelected($event)"
          [disabled]="uploading"
          class="file-input"
          id="profile-photo-input"
        />
        <div class="upload-status" *ngIf="uploading">
          <span class="upload-spinner">â³</span>
          <span>{{ i18n.translate('profile.uploading') }}</span>
        </div>
      </div>

      <div class="error" *ngIf="uploadError">
        {{ uploadError }}
      </div>

      <hr class="profile-separator" />

      <!-- Notifications -->
      <div class="notifications-section" *ngIf="notificationService.isSupportedBrowser">
        <h3 class="section-title">{{ i18n.translate('profile.notifications.title') }}</h3>
        <div class="notifications-control">
          <div class="notifications-info">
            <span class="notifications-icon">ğŸ””</span>
            <div class="notifications-text">
              <span class="notifications-label">{{ i18n.translate('profile.notifications.label') }}</span>
              <span class="notifications-status" *ngIf="notificationService.isPermissionGranted">
                {{ i18n.translate('profile.notifications.enabled') }}
              </span>
              <span class="notifications-status denied" *ngIf="notificationService.isPermissionDenied">
                {{ i18n.translate('profile.notifications.blocked') }}
              </span>
            </div>
          </div>
          <button
            type="button"
            class="notification-btn"
            (click)="toggleNotifications()"
            [disabled]="notificationService.isPermissionDenied || uploading"
          >
            <span *ngIf="!notificationService.isPermissionGranted">{{ i18n.translate('profile.notifications.enable') }}</span>
            <span *ngIf="notificationService.isPermissionGranted">{{ i18n.translate('profile.notifications.test') }}</span>
          </button>
        </div>
      </div>

      <button type="button" class="logout-btn" (click)="onLogout()" [disabled]="uploading">
        <span class="btn-icon">ğŸšª</span>
        <span>{{ i18n.translate('profile.logout') }}</span>
      </button>
    </div>

    <ng-template #noUser>
      <p>No user logged in.</p>
    </ng-template>
  </div>
</section>
