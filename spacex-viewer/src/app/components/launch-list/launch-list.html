<section class="wrap">
  <h2>Latest Launches</h2>

  <app-search-bar
    (queryChange)="onQuery($any($event))"
    [placeholder]="'Search by launch name...'"
  >
  </app-search-bar>

  <div class="pagination-controls-top">
    <label>
      Items per page:
      <select 
        [value]="(pageSize$ | async) || 10" 
        (change)="onLimitChange(+$any($event.target).value)"
      >
        <option value="5">5</option>
        <option value="10">10</option>
        <option value="20">20</option>
        <option value="30">30</option>
      </select>
    </label>
  </div>

  @if (loading$ | async) {
    <div>Loading...</div>
  }

  @if (error$ | async; as err) {
    <div class="error">{{ err }}</div>
  }

  @if (items$ | async; as launches) {
    <ul class="list">
      @for (launch of launches; track launch.id) {
        <app-item-card [item]="launch"></app-item-card>
      } @empty {
        <li class="row">No launches found.</li>
      }
    </ul>
  }

  <div class="pagination-controls">
    <ng-container *ngIf="currentPage$ | async as currentPage">
      <ng-container *ngIf="totalPages$ | async as totalPages">
        <ng-container *ngIf="hasPrevPage$ | async">
          <button 
            type="button" 
            (click)="onPageChange(currentPage - 1)"
            class="pagination-btn"
          >
            ← Previous
          </button>
        </ng-container>

        <span class="pagination-info">
          Page {{ currentPage }} of {{ totalPages }}
        </span>

        <ng-container *ngIf="hasNextPage$ | async">
          <button 
            type="button" 
            (click)="onPageChange(currentPage + 1)"
            class="pagination-btn"
          >
            Next →
          </button>
        </ng-container>
      </ng-container>
    </ng-container>
  </div>
</section>
